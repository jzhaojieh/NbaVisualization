{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Homework 6\"\nauthor: \"Dylan Hyun (dchyun)\"\ndate: \"3/1/2018\"\noutput: pdf_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(knitr)\nlibrary(kableExtra)\n```\n  \n##1.\n  \n```{r}\nload(\"engine.Rdata\")\neng.disp = engine.xtrain[,1]\nmpg = engine.ytrain[,1]\nfirst = data.frame(eng.disp,mpg)\ncolnames(first) = c(\"eng.disp\", \"mpg\")\nsummary(first)\n```\n  \n**A.**\n  \n```{r}\nplot(eng.disp, mpg)\nplot(eng.disp, 1/mpg)\n```\n  \nThe plot of 1/mpg vs. eng.disp appears to be more linear than the plot of mpg vs. eng.disp. While the plots appear to show that the data may actually be logrithmic, and benefit from a log transformation, \n  \n**B.**\n  \n```{r}\nm1 = lm((1/mpg)~eng.disp)\nplot(eng.disp, residuals(m1), ylab= \"Prediction Error (mpg)\")\nqqnorm(residuals(m1))\nqqline(residuals(m1))\n```\n\nThe residuals plot shows that some of the assumptions of the model may be violdated. First, it appears that as engine displacemenet increases, the variance of the residuals increases. Also, there is no data around eng.disp=200, so there could possibly be a pattern in the residuals that isn't fully being shown. The QQ plot shows that the data is generally normal, but there are some deviations from normality at the tails of the graph.  \n  \n**C.**\n  \n```{r}\nB=10000\nb1hats = rep(1:B)\nn1 = length(eng.disp)\nn2 = length(mpg)\nfor (i in 1:B) {\n  x_sample = sample(eng.disp,n1,replace=T);\n  y_sample = sample(mpg,n2,replace=T);\n  first_sample = data.frame(x_sample,y_sample)\n  model_sample = lm(y_sample~x_sample)\n  b1hats[i] = coefficients(model_sample)[2]\n}\nprint(mean(b1hats))\nprint(var(b1hats))\nprint(coefficients(m1))\nboot_se = sqrt(var(b1hats))\nlm_se = sqrt(sum(m1$residuals^2)/length(m1$residuals))\nchange = (boot_se-lm_se)/lm_se\nprint(change)\n```\n  \n  \n##2. \n  \n```{r}\nabalone = read.csv(\"fishdata.csv\")\n```\n  \n**A.**\n  \n```{r}\nplot(abalone$Diameter,abalone$Weight, pch = \".\", xlab=\"Diameter\", ylab=\"Weight\")\n```\n  \nA liner fit may be acceptable if the data is transformed. However, it does appear that the variance increases as diameter increases, so this would break one of the assumptions of the linear model. \n  \n**B.**\n  \n```{r}\nrhat = smooth.spline(abalone$Diameter,abalone$Weight,penalty = 0.002)\ny = abalone$Weight\nrhat$residuals=y-predict(rhat,abalone$Diameter)$y\nplot(abalone$Diameter, rhat$residuals, pch = \".\", xlab = \"Diameter\", ylab = \"Prediction Error (Weight)\")\n```\n  \nThe residual plot shows that there is a large increase in variance as the diameter increases. Also, the residuals are evenly spread around 0, showing that there are no patterns in the residuals. \n  \n**C.**\n  \n```{r}\ny0 = c()\nx0= c()\nfor (i in seq(100,650, by=5)){\n  x0 = c(x0,abalone$Diameter[i])\n  y0 = c(y0,abalone$Weight[i])\n}\nB = 1000\nrhatstars = matrix(nrow=B,ncol=111)\nn1 = length(abalone$Diameter)\nn2 = length(abalone$Weight)\nfor (i in 1:B) {\n  x_sample = sample(abalone$Diameter,n1,replace=T);\n  y_sample = sample(abalone$Weight,n2,replace=T);\n  first_sample = data.frame(x_sample,y_sample)\n  ssmod = smooth.spline(x_sample,y_sample,penalty = 0.002)\n  y = abalone$Weight\n  pred = predict(ssmod,x0)$y\n  for (j in (1:111)){\n    rhatstars[i,j] = pred[j]\n  }\n}\nci_uppers = rep(1:111)\nci_lowers = rep(1:111)\nx0_sort = sort(x0)\ny0_sort = sort(y0)\nfor (i in (1:111)){\n  pivotal = c(2*y0[i] - quantile(rhatstars[,i],.975),\n            2*y0[i] - quantile(rhatstars[,i],.025));\n  ci_uppers[which(x0_sort == x0[i])] = pivotal[1]\n  ci_lowers[which(x0_sort == x0[i])] = pivotal[2]\n}\nplot(abalone$Diameter,abalone$Weight,pch=\".\", xlab = \"Diameter\", ylab = \"Weight\")\nlines(x0_sort,predict(rhat,x0_sort)$y, col = \"gold\")\nlines(x0_sort,ci_uppers, lty=2, col = \"firebrick\")\nlines (x0_sort, ci_lowers, lty=2, col = \"firebrick\")\n\n\n```\n",
    "created" : 1520305292638.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1342966185",
    "id" : "9C1A69B",
    "lastKnownWriteTime" : 1519934835,
    "last_content_update" : 1519934835,
    "path" : "~/Documents/College/17/Spring/Regression/hw6.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}